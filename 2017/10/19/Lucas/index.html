<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="author" content="LingAndrew"><title> · LingAndrew</title><meta name="description" content="title: Lucasdate: 2017-10-18 22:57:36
tags: OILucas定理Lucas定理是用来求C（n,m）mod p 且p为质数时的方法。在noip范围内这基本是求该类问题最优的方法，不需考虑到适用范围的问题。
公式&amp;emsp;&amp;emsp;1.非递归：$$\bino"><meta name="keywords"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="renderer" content="webkit"><link rel="short icon" href="/images/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/css/blog_basic.css"><link rel="stylesheet" href="/css/font-awesome.min.css"><link rel="alternate" type="application/atom+xml" title="ATOM 1.0" href="/atom.xml"></head><body><div class="sidebar animated fadeInDown"><div class="logo-title"><div class="title"><img src="/images/logo@2x.png" style="width:127px;"><h3 title=""><a href="/">LingAndrew</a></h3><div class="description"><p>欢迎来到LingAndrew的杂货铺</p></div></div></div><ul class="social-links"></ul><div class="footer"><a target="_blank" href="/"><span>Theme by </span></a><a href="https://www.caicai.me"> CaiCai </a><span>&</span><a href="https://github.com/Ben02/hexo-theme-Anatole"> Ben</a><div class="by_farbox"><a href="https://hexo.io/zh-cn/" target="_blank">Proudly published with Hexo&#65281;</a></div></div></div><div class="main"><div class="page-top animated fadeInDown"><div class="nav"><li><a href="/">首页</a></li><li><a href="/about">关于</a></li><li><a href="/archives">归档</a></li><li><a href="/links">友链</a></li></div><div class="information"><div class="back_btn"><li><a onclick="window.history.go(-1)" class="fa fa-chevron-left"> </a></li></div><div class="avatar"><img></div></div></div><div class="autopagerize_page_element"><div class="content"><div class="post-page"><div class="post animated fadeInDown"><div class="post-title"><h3><a></a></h3></div><div class="post-content"><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>

<hr>
<p>title: Lucas<br>date: 2017-10-18 22:57:36</p>
<h2 id="tags-OI"><a href="#tags-OI" class="headerlink" title="tags: OI"></a>tags: OI</h2><h1 id="Lucas定理"><a href="#Lucas定理" class="headerlink" title="Lucas定理"></a>Lucas定理</h1><p>Lucas定理是用来求C（n,m）mod p 且p为质数时的方法。在noip范围内这基本是求该类问题最优的方法，不需考虑到适用范围的问题。</p>
<h3 id="公式"><a href="#公式" class="headerlink" title="公式"></a>公式</h3><p>&emsp;&emsp;1.非递归：<br>$$\binom{n}{m} = \prod_{i=0}^{k}\binom{n_i}{m_i}(mod\;p)$$<br>&emsp;&emsp;这是将n ， m视为p进制然后进行构造的。</p>
<p>&emsp;&emsp;2.递归<br>$$\binom{n}{m} = \binom{n/p}{m/p}\binom{n%p}{m%p}(mod\;p)$$<br>&emsp;&emsp;这时候需要使用递归的方式，不断对$\binom{n/p}{m/p}$进行求值即可获得答案。递归的终点是p=0；</p>
<h3 id="不正经的证明"><a href="#不正经的证明" class="headerlink" title="不正经的证明"></a>不正经的证明</h3><blockquote>
<p>链接:<a href="https://baike.baidu.com/item/lucas/4326261?fr=aladdin" target="_blank" rel="external">https://baike.baidu.com/item/lucas/4326261?fr=aladdin</a><br>其实就是复述一下百科对于递归式的证明（逃Σ(っ °Д °;)っ</p>
</blockquote>
<p>&emsp;&emsp;对于$\binom{n}{m}$,我们令n=sp+q,m=tp+r，<br>那么原递归式就可以改写成<br>$$\binom{sp+q}{tp+r}\equiv\binom{s}{t}\binom{q}{r}(mod\;p)$$</p>
<hr>
<p>1.首先根据组合数的基本求值公式可以看出来：<br> $$\binom{n}{m}=\frac {n!}{m!(n-m)！} $$<br> &emsp;&emsp;若在$mod\;p$下，令n=p，那么p可以整除$\binom{p}{m}$，也就是说余数为零，于是可以得到:<br> $$\binom{p}{f}\equiv0(mod\;p)$$<br>  &emsp;&emsp;所以对于<br>  $$(1+x)^n(mod\;p)$$<br>   &emsp;&emsp;我们把这个二项式展开，发现在二项式系数中，除了首项末项均为1，其他系数均满足我们得到的式子，从而被消除。故我们又可以得到：<br>   $$(1+x)^n\equiv1+x^n(mod\;p)$$<br>&emsp;&emsp;有了这个前置，我们就可以为所欲为了：<br>$$(1+x)^n\equiv(1+x)^sp+q\equiv[(1+x)^p]^s(1+x)^p$$<br>$$\equiv(1+x^p)^s(1+x)^q(mod\;p)$$<br>$$\equiv\sum<em>{i=0}^s\binom{s}{i}·x^{i·p}·\sum</em>{j=0}^q\binom{q}{j}·x^j(mod\;p)$$<br>&emsp;&emsp;看似难懂，其实都是已知的知识（最后一个式子则是$(1+x^p)^s(1+x)^q(mod\;p)$的二项式展开）。所以我们最终得到:</p>
<p>$$(1+x)^{sp+q}\equiv\sum<em>{i=0}^s\binom{s}{i}·x^{i·p}·\sum</em>{j=0}^q\binom{q}{j}·x^j(mod\;p)$$</p>
<hr>
<p>2.我们重新观察一下这个式子：</p>
<p>&emsp;&emsp;左边：将二项式展开后，其中$x^{tp+r}$的二项式系数为$\binom{sp+q}{tp+r}$<br>&emsp;&emsp;右边：整理格式后$\sum<em>{i=0}^{s}\sum</em>{j=0}^{q}{\binom{s}{i}\binom{q}{j}}x^{i·p+j}(mod\;p)$类似于一个二重嵌套循环不是么，也就是说右边=每一个$\binom{s}{i}\binom{q}{j}x^{i·p+j}$的总和。看透了这一点，我们便可以得出结论：</p>
<blockquote>
<p>当且仅当i=t，j=r时，能够得到$x^{tp+r}$的系数$\binom{s}{t}\binom{q}{r}$</p>
</blockquote>
<p>故：<br>$$\binom{sp+q}{tp+r}\equiv\binom{s}{t}\binom{q}{r}(mod\;p)$$<br>原式得证。</p>
<h3 id="Code："><a href="#Code：" class="headerlink" title="Code："></a>Code：</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">namespace Lucas_Method</div><div class="line">&#123;</div><div class="line">	typedef long long ll;</div><div class="line"></div><div class="line">	ll quick_pow(ll a , ll b ,ll p) &#123;</div><div class="line">		ll ans = 1;</div><div class="line">		for(; b ; b &gt;&gt;= 1 , a = a*a%p)</div><div class="line">			if(b &amp; 1) ans = ans * a % p;</div><div class="line">		return ans;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	ll Calc(ll a , ll b ,ll p) &#123;</div><div class="line">		if(a &lt; b) return 0;</div><div class="line">		else if(a == b) return 1;</div><div class="line"></div><div class="line">		if(b &gt; a-b) b = a-b;</div><div class="line">		ll ans = 1 , ca = 1 , cb = 1;</div><div class="line">		for(ll i = 0 ; i &lt; b ; i++) &#123;</div><div class="line">			ca = (ca * (a-i)) % p;</div><div class="line">			cb = (cb * (b-i)) % p;</div><div class="line">		&#125;</div><div class="line">		ans = (ca*quick_pow(cb,p-2,p))%p;</div><div class="line">		return ans;</div><div class="line">	&#125;</div><div class="line">	ll ans = 1;</div><div class="line">	ll Lucas(int n , int m , ll p) &#123;</div><div class="line">		ans = (ans * Calc(n%p , m%p ,p)) %p;</div><div class="line">		if(!n || !m || !ans) return ans;</div><div class="line">		return Lucas(n/p , m/p , p);</div><div class="line">	&#125;</div><div class="line">    /*</div><div class="line">	/ll Lucas(int n , int m , ll p) &#123;</div><div class="line">		ll ans = 1;</div><div class="line">		while(n &amp;&amp; m &amp;&amp; ans) &#123;</div><div class="line">			ans = (ans * Calc(n%p , m%p ,p)) %p;</div><div class="line">			n /= p;</div><div class="line">			m /= p;</div><div class="line">		&#125;</div><div class="line">		return ans;</div><div class="line">	/&#125;</div><div class="line">    */</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div><div class="post-footer"><div class="meta"><div class="info"><i class="fa fa-sun-o"></i><span class="date">2017-10-19</span><i class="fa fa-tag"></i></div></div></div></div><div class="share"><div class="evernote"><a href="javascript:(function(){EN_CLIP_HOST='http://www.evernote.com';try{var%20x=document.createElement('SCRIPT');x.type='text/javascript';x.src=EN_CLIP_HOST+'/public/bookmarkClipper.js?'+(new%20Date().getTime()/100000);document.getElementsByTagName('head')[0].appendChild(x);}catch(e){location.href=EN_CLIP_HOST+'/clip.action?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title);}})();" ref="nofollow" target="_blank" class="fa fa-bookmark"></a></div><div class="weibo"><a href="javascript:void((function(s,d,e){try{}catch(e){}var f='http://service.weibo.com/share/share.php?',u=d.location.href,p=['url=',e(u),'&amp;title=',e(d.title),'&amp;appkey=2924220432'].join('');function a(){if(!window.open([f,p].join(''),'mb',['toolbar=0,status=0,resizable=1,width=620,height=450,left=',(s.width-620)/2,',top=',(s.height-450)/2].join('')))u.href=[f,p].join('');};if(/Firefox/.test(navigator.userAgent)){setTimeout(a,0)}else{a()}})(screen,document,encodeURIComponent));" class="fa fa-weibo"></a></div><div class="twitter"><a href="http://twitter.com/home?status=,http://lingzichao.github.io/2017/10/19/Lucas/,LingAndrew,,;" class="fa fa-twitter"></a></div></div><div class="pagination"><ul class="clearfix"><li class="next pagbuttons"><a role="navigation" href="/2017/10/18/hello-world/" title="Hello World" class="btn">下一篇</a></li></ul></div></div></div></div></div><script src="/js/jquery.js"></script><script src="/js/jquery-migrate-1.2.1.min.js"></script><script src="/js/jquery.appear.js"></script></body></html>